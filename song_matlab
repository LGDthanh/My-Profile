clear;
SNR_dB = -10:2:10;
SNR = 10.^(SNR_dB/10);
%OQPSK
OQPSK = 2*qfunc(sqrt(2*SNR));
SNR_simul = [-10 -8 -6 -4 -2 0 2 4 6 8 10];
OQPSK_simul = [0.327360423009289 0.286714527581443 0.239228710767672 0.186113817483389 0.130644488522829 0.0786496035251426 0.0375061283589260 0.0125008180407376 0.00238829078093281 0.000190907774075993 3.87210821552205e-06];
semilogy(SNR_dB,OQPSK,SNR_simul ,OQPSK_simul ,'r--+', 'linewidth',2);
xlabel('SNR (dB)');
ylabel('Bit Error Rate');
title('Bit Error Rate vs. Eb/No');
hold on;
%8-PSK
M = 8;
PSK8 = 2*qfunc(sqrt(4*SNR)*sin(pi/(2*M)));
PSK8_simul = [0.901801479636750 0.876558239661662 0.844959613994496 0.805537212902556 0.756613046248300 0.696402973434632 0.623279109358520 0.536315225850904 0.436266801917431 0.327041958681784 0.217255250602889];
semilogy(SNR_dB,PSK8,SNR_simul ,PSK8_simul ,'b--*', 'linewidth',2);
hold on;
%16-PSK
M = 16;
PSK16 = 2*qfunc(sqrt(4*SNR)*sin(pi/(2*M)));
PSK16_simul = [0.950569614829235 0.937794124404146 0.921733876449071 0.901561308388506 0.876257228446250 0.844583334442052 0.805068786102641 0.756033717510376 0.695693893839099 0.622425396913119 0.535313864013823];
semilogy(SNR_dB,PSK16,SNR_simul ,PSK16_simul ,'y--x', 'linewidth',2);
hold on;
%16-QAM
M = 16;
SNR1_dB=3*SNR_dB/(M-1);
SNR1 = 10.^(SNR1_dB/10);
QAM16 = 2*(1-1/sqrt(M))*erfc(sqrt(SNR/2));
QAM16_simul = [1.12774445106877 1.03582678348061 0.924359037197294 0.792102622914054 0.640506556512018 0.475965761794371 0.312085911256166 0.169485905248085 0.0690214166335981 0.0180131592004907 0.00234810338700382];
semilogy(SNR_dB,QAM16,SNR_simul ,QAM16_simul ,'y--*', 'linewidth',2);
hold on;
QAM16_1 = [0.743 0.6786 0.587 0.478 0.351 0.221 0.11 0.037 0.007 0.0006 1.2e-5];
semilogy(SNR_dB,QAM16,SNR_simul ,QAM16_1 ,'r--*', 'linewidth',2);
